"use strict";var u=Object.create;var s=Object.defineProperty;var K=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,d=Object.prototype.hasOwnProperty;var x=(r,e)=>{for(var t in e)s(r,t,{get:e[t],enumerable:!0})},a=(r,e,t,c)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of m(e))!d.call(r,i)&&i!==t&&s(r,i,{get:()=>e[i],enumerable:!(c=K(e,i))||c.enumerable});return r};var y=(r,e,t)=>(t=r!=null?u(g(r)):{},a(e||!r||!r.__esModule?s(t,"default",{value:r,enumerable:!0}):t,r)),l=r=>a(s({},"__esModule",{value:!0}),r);var v={};x(v,{asJWK:()=>b,asPEM:()=>P,createKeyPair:()=>n,fromRawPrivateKey:()=>f,sign:()=>w,verify:()=>k});module.exports=l(v);var o=y(require("crypto")),p=y(require("../config"));const f=async r=>o.default.createPrivateKey({format:"der",key:r,type:"pkcs8"}),n=async()=>{const r=await f(p.default.PRIVATE_KEY),e=o.default.createPublicKey(r);return{privateKey:r,publicKey:e}},w=async r=>{const{privateKey:e}=await n();return o.default.sign(null,Buffer.from(r),e).toString("hex")},k=async(r,e)=>{const{publicKey:t}=await n();return o.default.verify(null,Buffer.from(r),t,Buffer.from(e,"hex"))},P=async()=>{const{publicKey:r}=await n();return r.export({format:"pem",type:"spki"}).toString()},b=async()=>{const{publicKey:r}=await n(),e=r.export({format:"jwk"});if(e.x===void 0)throw new Error("Failed to derive public key");const t=o.default.createHash("sha256").update(e.x).digest("base64");if(!t.trim())throw new Error("KeyId cannot be empty");if(e.crv!=="Ed25519"||e.kty!=="OKP"||!e.x)throw new Error("Key is not EdDSA-Ed25519");return{alg:"EdDSA",kid:t,kty:e.kty,crv:e.crv,x:e.x}};0&&(module.exports={asJWK,asPEM,createKeyPair,fromRawPrivateKey,sign,verify});
//# sourceMappingURL=index.js.map
